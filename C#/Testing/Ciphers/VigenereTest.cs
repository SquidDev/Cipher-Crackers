using Cipher.Ciphers;
using Cipher.Text;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Testing.Ciphers
{
    /// <summary>
    /// Summary description for VigenereTest
    /// </summary>
    [TestClass]
    public class VigenereTest
    {

        string Encoded = "SHDTVVPDSWMRPAWAMQAIGRUDVGJMIAXMNNTWHDAGKUHBPBVEIQUILRTAWAILJJGBOPLVFVWSZMVVBKAOOVTTFOPTQHWUGZIAABKIIOVHQQAGTLWVGEMAGQWGWCIGJIGHVXCGVHDRPRPQFRVKXGLWHZMAETRSZLEGXRRONEQUWHZVNBQDRXPVXMVTCMZQVDLDANJIVHVLNRZHTOGNFDHNOCEQCVTDURQDHROPRNIVTAWEVGBEVZFVPHNVHVULLSXWIGZHDOPNVXHRPOTKIZANIACAVOXQNVMRFOPRIPHTOWSCULLTIAFBKAOISVMUHZPNFBDKZVGJMSADVGKVJTJQGCTBIOPNFJHEIQAVPHIMKHUBRDTNBTIWLZIFVARMZXNTBRFOPRVERYZIEUQWWVAZKAVIIOEGIGTCMEGXRROGBWZVEGNNPLBOPEVNTVEZBUCBWHZGPCUHTJBUGKRNXTHUQRNOPNVBKEBPRVBRSCMYFWQTJPRTJHCVCFGBKETKBWTGNOUNMMDCJVIKVFIIOSQZJEMGVFWQTWCLVPDTVVQKLRNOJRNQHVZBUCBWHZGJQCODCIIGTHTKMEWOJIVWSHMUIOBBCVBOIMRNAHOIKRVPHYCIQJWODJNVVBKEHARNDHSOPRPICINPNXMIAGTRPNRROPRUIPEOZVESWHVBSQWOEYMIGZBOIMRNAHTCMCTMWEIKRVPDTOPRRILNOQAIXHRPOTKIVHJERFBRGZZVYIVTCMBTQJIIIYKBZANISCSHPJAFKJOYOPRDMVTAIXGQQAMBUKAWOMGVFWQTFVBYEKEOPRTXHRPOTKIZANQAQVWHZLREMSTDWAQZQOOOVXMQTCMVTANIGTFVPHGCMGVWIAHQYAKDNOPNXMEEZVFJWUTJNZQVHYJZVPNOUZVPGIQDCMJCAQOOQAUQGEAWENWQGZQGJMUWVGGJMIAFMJCAUENBBTMGTJNECVFEVVQVPHOMQTKVDLRIFJQGDZVNYIBWCMAHIOSXPHPORRYMEGLVAMIGQKRPTBUGXDRDAZQVDLDANJMEEGQRXMGAGWAIELTCBUGZHSOWSVPHWJZYFBKAOQGYIVTCMBTQJIIIYUIUAHCFVPDVZSAQEQTCMGTCHSOWEAIQDKZBFCFEYIAGEDNYIYOWVTKMEHMFTAIXGNRRCQZDCWUNMQCVRLYAPTISOATRCLSIKMSTWPTCMPGTOAMBBOIUKOPRDWDRYEVVPWHZVNBQHMWTROSQORQAIBKAOIGUWPEKWVPBWHZNBTOHRTEBWTGBZLVUKRVZZRFAKEHCFVPDVZPBRMGTCIGVPHNVHVUERUGLOGJOAHMQHWUTCMGJMITJNGJMPOIIYKADPMWIKLLNBBUGXHRAMPVKRVZZSQZKEMWJPNDMDTLUWUIBQACTFRDURVPDTGMSVWQEHGFVMUYRPRTMZANBUGXDIIBVPOVHZZRRTDCZLFJMFOPTQPBKAQMGTIYEGTRFARUOPJKBKTCMCGZXGBQNHWUGZZLUQQCZQGYIVPVQAVMGOIIOQIUDIWGUWPEOPVPOVHZKBWTGEVAVNGFOIKRCTVONPROCVTCIIGTHFOBUGXDIIBVPOEECQAFJXTVKPQZGIIOGQBKEMMCQZWTCMUQCVEDVZQVWMVZGTMZANBUQZRUBPYAAHAMKUGLEYZFCGZWSOPRPQVARQGJMUTJWYUIQDRWEMALNOPRXMQIXMNRIUTHMAVEHRZPVFLHNWMUKVGTCMCCVHLNQEGUHMWMEGLVAMIFTMPAMSSTWPHZZQKIUYDENUVHAMTLEIXGCBYCAWNDOUVPHCVURVWFHZKXQVPEVVQKRXSOPNFBLMZBBVCUNOPREIQVVANIILNNBGJMZAGTVPBKENPNFWZSOPROWQAGQFCEDSIBCCQQTZLBPKDNQIFUWZHVBRNAHWJCYFAKECIIGJHEIXNKVWIIOVVWRKVTBQSGORVGJMUEOPVUIITZZAQWQIOQFXMUYYIEMQQTCMOCKNCJZAGZRFOPNVKHLGIEYQWHIWACBXRVTYKOKTVVQCBKIXSPQIWIIOBHLLROIAFLXSOWAVPHWVTYUEKIXPFGMPSOWNDARRWIAAQOLPUVPIWIJVYGIYIIOVVPDRYBBOINEJCGFMWADTFGDHNRQGJIJOJLGQZFHDNLQCGIYVGMVRWDBJCAWHZZRAWXWJCYFVHVZZSKVGIOJRJQQDVKNOWXFGITGLILVXCKVQEYBBVPHWVTYKNRUILGJMSEMCTIQDCJXLVPHDDATWQVERIFCERRFWSCZWTCMPCVYANBUKKNLTKBCBHDRQGJJUIXSQWAWAILQKZWMDFRFELTCJVPLHRNAUGUXSOPNXMVMPOTNMGDJEAHZRMOPRCBWIXAGWLLODBJCAIANBRPMGTJBUGEDLGEVVPVOABYGIGWZLTGAMAHURFQQTJBUGKUAXSFKVWHZUBTBDRZIFABRRZUBXMEUOMNUQOYXWIGZHDRQGJURRZWSVPHDDZGKKDNNMRYPBNJWAGASOOBRFQWBZNBTMWHZXRTCJGDIPQXBWVANPWWHZZZCAWEMXVGKHBPBVVJHGNBUGYXENBVQVRFRPRTMWHZWEKOLNVTZKOKTWMVCUQOOAHTMZERQYNMYEMNVPLLTVVQKIPCZZGCQQTCMSTMQCCEVNTQOOTVMMLTDNJGBHLGBUGUWHVBVYWXLYAHIOHSOBUCBZEFMRRQWTJWHTAHLQMFUQQCZBUGXHRPOTKIFOKGJCAGENQTPMGTJAGCGXNYMGGKWEYCANQNEOPRGIJLZMZDTHMQMEUQRNHILDMZENPBWTGSRQGEPWHZUNPLIOMORVIEOPBVVEHCVVOWZQTCMACHLVZZFKWQAILZCGEEIWBPMZIGTRXMUKIWJVPDTOPRRILNOQAIQQTCMYQCYRZQFLCVTVKBRGVOHMJJMUEJCGVPHRZANTIDNYPRTNDMDTLCZHGPIEFQQGOPRQZLGDVNNIQDDNVGDHRBMGVPHCCIAEMLPGIAVWJOCCAVQQGAWEKBPATJRAWXWJCYFRRIIURJIURT";
        string Plain = "PHILITHASBEENSTARINGYOUINTHEFACEALLTHISTIMEBUTICANUNDERSTANDWHYYOUDIDNTSEEITTHATGIRLCOULDFORGEANYTHINGIFINALLYUNDERSTOODWHATHADHAPPENEDWHENICRACKEDTHEENCLOSEDREPORTFROMTHENAZIARCHIVESTHEMONALISAHASHADAPRETTYADVENTUROUSTIMEOVERTHELASTFORTYYEARSTHENAZISDISCOVEREDTHATPERUGGIAWASANASSOCIATEOFTHEGHETTOFAMILYANDTHATAFTERHEHADTAKENTHEPAINTINGTOITALYITHADBEENINTHEIRCUSTODYFORATLEASTSOMEPARTOFTHETWOYEARSITWASMISSINGREADTHEREPORTYOURSELFANDYOUWILLSEETHATTHEYCAMETOTHECONCLUSIONTHATTHEGHETTOSHELDONTOHERBECAUSETHEYCOULDNTMAKEACONVINCINGFORGERYIDONTBUYTHATANDIDONTBELIEVETHATTHEYWOULDHAVELETPERUGGIAOFFERITTOANYONEELSEONCETHEYHADHOLDOFITTHEMSELVESTHENAZISHAVEFALLENFORTHESAMETRICKTHATFOOLEDEVERYONEELSETHEPRETENCETHATTHEPAINTINGPERUGGIASHOWEDTOGERIWASTHEORIGINALITWASAFAKEPOSSIBLYTHEBESTFAKEINARTHISTORYIDONTKNOWWHETHERPERUGGIAWASINONTHEDECEPTIONORNOTGIVENTHEIRSKILLSTHEGHETTOFAMILYCANTHAVEBEENSHORTOFMONEYORINFLUENCEANDHEWASNOTINSIDEFORLONGEITHERWAYTHEFAKEWASRESTOREDTOFRANCEANDTHEORIGINALWASHIDDENAWAYWHENFALSCHUNGORDEREDSARATOCOPYTHEPARISMONALISAHEBELIEVEDALONGWITHTHERESTOFTHEWORLDTHATITWASTHEORIGINALSARAMUSTHAVEKNOWNTHETRUESTORYANDPRODUCEDANEWANDALMOSTPERFECTFAKEFORHIMBUTUSEDANOLDSCRAPOFLEADPIPEFROMTHECELLARTOMARKTHEBOARDWITHTHENAZIEMBLEMKNOWINGTHATATSOMEPOINTTHEFORGERYWOULDBEDISCOVEREDSHEMUSTHAVEHOPEDTHATTHENAZISWOULDBEBLAMEDFORTHETHEFTOFTHEMONALISAPROVIDINGTHEPERFECTCOVERFORHEROWNFAMILYSORIGINALCRIMETHATLEFTONEMYSTERYWHEREWASTHEPAINTINGSHEREPLACEDSHECOULDNTHAVETRAVELLEDSOUTHWITHTHEPERUGGIAFORGERYSINCEITWASPAINTEDONABOARDNOTSOMETHINGSHECOULDEASILYCONCEALSOSHEMUSTHAVELEFTTHEPAINTINGBEHINDBUTACCORDINGTOTHEREPORTTHEHOUSEINMONTMARTREWASTHOROUGHLYSEARCHEDBYEXPERTSTHENISAWITHERTOOLSANDWORKSINTHEVENICEAPARTMENTWEREHIDDENBEHINDTHEPANELSIREMEMBEREDSARASREMARKFROMHERDIARYIWASNEARLYCAUGHTLASTNIGHTHECAMETOCHECKONMEANDIJUSTHADTIMETOTURNTHECANVASAGAINSTTHEWALLINTHESHADOWSTHEMONALISAWASNTPAINTEDONCANVASSOWHATELSEWOULDSHEHAVEBEENPAINTINGITOOKALOOKDOWNTHERETHISAFTERNOONITISVERYDARKINTHEBACKCORNEROFTHATCELLARWITHNONATURALLIGHTANDATHICKCOATINGOFDIRTANDDUSTONTHEWALLSWHICHSEEMSTOABSORBANYILLUMINATIONLEAVINGITHARDTOMAKEOUTDETAILSEVENWITHAGOODTORCHIFYOUDIDNTKNOWITWASTHEREYOUWOULDNEVERFINDITBEHINDACAMOUFLAGEDFLAPPINNEDTOTHEWALLIFOUNDTHEPERUGGIACOPYTHEDISGUISEWASAWORKOFARTTHECANVASTHICKLYCOATEDWITHBRICKDUSTANDDIRTMIXEDWITHBINDERSSHEMUSTHAVESMUGGLEDDOWNFROMTHEATTICSTUDIOITWASFASTENEDTOTHEWALLWITHSOFTLEADWEDGESJAMMEDINTOTHECRACKSINTHEMORTAREASYTOREMOVEBUTEASILYCOVEREDWITHMOREOFTHEDIRTICANSEEWHYNOONESPOTTEDITBEFORETHEPERUGGIACOPYWASANOTHERMASTERPIECEBUTITBEGSTHEQUESTIONOFWHERETHEORIGINALMIGHTBEIAMNOTSUREWEWILLEVERFINDITANDIAMCERTAINTHEFRENCHWILLNOTLIKEITIFWETELLTHEMTHATIWOULDSUGGESTTHATWEKEEPITTOOURSELVESSINCETHEPERUGGIACOPYWASDESIGNEDTOSTAYUNDETECTEDUNLIKETHEEAGLEEMBLEMVERSIONMAYBEWESHOULDSWITCHTHEMANDFORGETABOUTITWECANBURNTHENAZIVERSIONANDMAYBENOONEWILLEVERKNOWTHATTHEPAINTINGINTHELOUVREISJUSTACOPYSOMEWHEREOUTTHERESARAANDHERFAMILYAREGUARDINGTHEORIGINALANDIFIEVERGETTHECHANCEIPLANTOGOHUNTINGFORITMAYBEYOUWOULDJOINMEHARRY";
        string Key = "DAVINCI";

        [TestMethod]
        public void VigenereDecode()
        {
            Vigenere<QuadgramScoredLetterArray> Shift = new Vigenere<QuadgramScoredLetterArray>(Encoded);
            QuadgramScoredLetterArray Result = Shift.Decode(new QuadgramScoredLetterArray(Key));

            Assert.AreEqual(Plain, Result.ToString());
        }

        [TestMethod]
        public void VigenereMonogramCrack()
        {
            MonogramVigenere Shift = new MonogramVigenere(Encoded);
            MonogramVigenere.CipherResult Result = Shift.Crack();

            Assert.AreEqual(Plain, Result.Text.ToString());
            Assert.AreEqual<string>(Key, Result.Key.ToString());
        }
    }
}
